---
title: "Study 6: Advanced Velocity-RIR Analyses"
subtitle: "Novel Analyses for Velocity-Based Training Prescription"
author:
  - name: "João Costa"
    affiliation: "Sport Science Research"
  - name: "Filipe Braga"
    affiliation: "MSc Thesis Research"
date: today
format:
  html:
    toc: true
    toc-depth: 3
    code-fold: true
    code-summary: "Show code"
    theme: cosmo
    fig-width: 10
    fig-height: 6
execute:
  warning: false
  message: false
---

```{r setup}
#| include: false

# Suppress warnings globally
options(warn = -1)

# Load required packages
library(ggplot2)
library(knitr)

# Set theme
theme_set(theme_minimal(base_size = 12))

# Load pre-computed results from analysis script
# Run `make analyze-advanced` first to generate this file
results <- readRDS("../data/processed/advanced_velocity_results.rds")

# Extract components
data <- results$data
summary_stats <- results$summary
mvt_result <- results$mvt
reliability <- results$reliability
poly_result <- results$polynomial_comparison
decay <- results$velocity_decay
prediction <- results$failure_prediction
```

## Executive Summary

This study presents five novel analyses (H2-H6) that extend our understanding of the deadlift velocity-RIR relationship, addressing key gaps in the velocity-based training literature that have practical implications for coaches and athletes.

### Background and Motivation

Studies 4 and 5 established the fundamental velocity-RIR relationship for deadlifts and provided practical velocity tables. However, several questions remain unanswered:

1. **How variable is the failure velocity across individuals?** If everyone fails at the same velocity, a universal threshold works. If not, individual calibration is essential.

2. **How stable are individual velocity profiles across days?** This determines how often athletes need to recalibrate their velocity zones.

3. **Is the velocity-RIR relationship linear or curved?** This affects the mathematical model we should use.

4. **Does velocity loss accelerate within a set?** This has implications for when to stop a set to preserve rep quality.

5. **Can we predict set capacity from the first rep?** This would enable real-time autoregulation without counting reps.

This study addresses each of these questions with dedicated analyses.

### Key Findings

| Analysis | Result | Practical Implication |
|----------|--------|----------------------|
| **H2: MVT Variability** | CV = `r round(mvt_result$population_stats$cv_percent, 1)`% | Individual calibration essential |
| **H3: Day Reliability** | Slope ICC = `r round(reliability$slope_icc$icc, 2)` | Periodic recalibration needed |
| **H4: Model Comparison** | `r round(poly_result$best_model_summary$pct_quad_best, 1)`% prefer quadratic | Linear model adequate |
| **H5: Velocity Decay** | Accelerates (p = `r format(decay$decay_acceleration$p_value, digits = 3)`) | Non-linear considerations |
| **H6: Failure Prediction** | MAE = `r round(prediction$cv_results$mae, 2)` reps | First rep velocity useful |

## Experimental Setup

### Study Design

```{r data-summary}
#| echo: false

cat("Participants:", summary_stats$n_participants, "\n")
cat("Total observations:", summary_stats$n_observations, "\n")
cat("Total sets:", summary_stats$n_sets, "\n")
cat("Reps per set:", summary_stats$reps_per_set_range[1], "-",
    summary_stats$reps_per_set_range[2],
    "(mean:", round(summary_stats$mean_reps_per_set, 1), ")\n")
```

**Protocol:**

- **Participants**: 19 resistance-trained individuals (15 male, 4 female)
- **Exercise**: Conventional deadlift
- **Loads**: 80% and 90% of 1RM
- **Testing days**: 2 separate days
- **Protocol**: Each participant performed sets to muscular failure at both loads on both days
- **Measurement**: Mean concentric velocity (MCV) for each repetition using linear position transducer

**Data Structure:**

Each observation represents a single repetition within a set to failure:

```{r data-structure}
#| echo: false

kable(head(data[, c("id", "day", "load_percentage", "set_id", "rep_number", "rir", "mean_velocity", "reps_to_failure")], 10),
      caption = "Sample data structure (first 10 rows)")
```

## H2: Minimum Velocity Threshold (MVT) Variability

### Research Question

**How variable is the velocity at muscular failure (RIR=0) across individuals?**

### Theoretical Background

The **Minimum Velocity Threshold (MVT)** represents the velocity at which an athlete can no longer complete a repetition---essentially, their "failure velocity." This concept was introduced by González-Badillo & Sánchez-Medina (2010) for the bench press, where they observed relatively consistent MVT values across individuals (~0.17 m/s).

If MVT is consistent across individuals, it could serve as a **universal failure indicator**---coaches could prescribe a "stop velocity" that works for all athletes. However, if MVT varies substantially, **individual calibration becomes essential**.

### Why This Matters for Deadlifts

The deadlift may show different MVT patterns than other exercises because:

1. **No stretch-shortening cycle**: Failure occurs from a dead stop, potentially affecting the velocity profile
2. **Grip as a limiter**: Some athletes may fail due to grip rather than posterior chain exhaustion
3. **Binary failure pattern**: Unlike grinding through a squat, deadlifts either leave the floor or they don't

### Methods

1. Extracted all observations at RIR = 0 (failure reps)
2. Calculated population-level MVT statistics (mean, SD, CV, IQR)
3. Calculated individual MVT for each participant
4. Tested for sex differences using Mann-Whitney U test (non-parametric due to small groups)
5. Tested for load differences (80% vs 90%) using paired comparison

### Results

```{r h2-population}
#| echo: false

cat("Population MVT Statistics:\n")
cat("  Mean:", round(mvt_result$population_stats$mean, 3), "m/s\n")
cat("  SD:", round(mvt_result$population_stats$sd, 3), "m/s\n")
cat("  CV:", round(mvt_result$population_stats$cv_percent, 1), "%\n")
cat("  IQR:", round(mvt_result$population_stats$iqr, 3), "m/s\n")
cat("  Range:", round(mvt_result$population_stats$min, 3), "-",
    round(mvt_result$population_stats$max, 3), "m/s\n")
```

```{r h2-plot}
#| fig-cap: "Distribution of Minimum Velocity Threshold (MVT) at failure"

# Extract failure data
failure_data <- data[data$rir == 0, ]

# Density plot
ggplot(failure_data, aes(x = mean_velocity)) +
  geom_histogram(aes(y = after_stat(density)), bins = 20, fill = "steelblue", alpha = 0.7) +
  geom_density(color = "darkred", linewidth = 1) +
  geom_vline(xintercept = mvt_result$population_stats$mean,
             linetype = "dashed", color = "black", linewidth = 1) +
  annotate("text", x = mvt_result$population_stats$mean + 0.02, y = 5,
           label = paste("Mean =", round(mvt_result$population_stats$mean, 3), "m/s"),
           hjust = 0) +
  labs(x = "Velocity at Failure (m/s)", y = "Density",
       title = "MVT Distribution Across All Failure Observations") +
  theme_minimal()
```

```{r h2-individual}
#| fig-cap: "Individual MVT values showing between-participant variability"

# Individual MVT plot
ind_mvt <- mvt_result$individual_stats
ind_mvt <- ind_mvt[order(ind_mvt$mean_mvt), ]
ind_mvt$id <- factor(ind_mvt$id, levels = ind_mvt$id)

ggplot(ind_mvt, aes(x = id, y = mean_mvt, color = sex)) +
  geom_point(size = 3) +
  geom_errorbar(aes(ymin = mean_mvt - sd_mvt, ymax = mean_mvt + sd_mvt),
                width = 0.3) +
  geom_hline(yintercept = mvt_result$population_stats$mean,
             linetype = "dashed", color = "gray50") +
  coord_flip() +
  labs(x = "Participant", y = "MVT (m/s)",
       title = "Individual MVT with Standard Deviation",
       color = "Sex") +
  scale_color_manual(values = c("female" = "#E41A1C", "male" = "#377EB8")) +
  theme_minimal()
```

**Load Comparison:**

```{r h2-load}
#| echo: false

cat("80% 1RM MVT:", round(mvt_result$load_comparison$load_80_mean, 3),
    "±", round(mvt_result$load_comparison$load_80_sd, 3), "m/s\n")
cat("90% 1RM MVT:", round(mvt_result$load_comparison$load_90_mean, 3),
    "±", round(mvt_result$load_comparison$load_90_sd, 3), "m/s\n")
cat("Difference:", round(mvt_result$load_comparison$difference, 3), "m/s\n")
cat("p-value:", format(mvt_result$load_comparison$wilcox_p, digits = 4), "\n")
cat("Significant:", mvt_result$load_comparison$significant, "\n")
```

### Interpretation

The coefficient of variation (CV = `r round(mvt_result$population_stats$cv_percent, 1)`%) indicates **high inter-individual variability** in MVT. This finding has important practical implications:

1. **A single MVT value cannot be applied to all athletes** - using a population mean (0.21 m/s) would underestimate capacity for some and overshoot for others
2. **Individual calibration is essential** - each athlete needs their own MVT determined through testing to failure
3. **No significant load effect** - MVT appears similar at 80% and 90% 1RM, suggesting MVT is an individual characteristic independent of load

## H3: Day-to-Day Reliability

### Research Question

**Are individual velocity-RIR relationships stable across testing days?**

### Theoretical Background

The practical utility of VBT depends critically on the **reliability** of individual velocity profiles. Reliability refers to the consistency of measurements across repeated testing occasions. In the context of VBT:

- **High reliability** means an athlete's velocity-RIR curve is stable---once calibrated, the velocity zones remain valid for an extended period
- **Low reliability** means the curve shifts substantially between sessions, requiring frequent recalibration

The **Intraclass Correlation Coefficient (ICC)** is the standard metric for assessing reliability of continuous measures. We use ICC(2,1)---a two-way random effects model assuming both raters (days) and subjects are random samples from larger populations (Shrout & Fleiss, 1979).

### Why This Matters

If velocity profiles are reliable day-to-day:

- A **single calibration session is sufficient** to establish individual velocity zones
- Athletes don't need frequent retesting
- Coaches can trust that velocity thresholds remain valid

If velocity profiles are unreliable:

- Athletes need **frequent recalibration** (perhaps weekly or monthly)
- Session-to-session factors (fatigue, recovery, motivation) may affect velocity targets
- VBT becomes less practical for day-to-day training prescription

### Methods

1. Fit individual linear models (velocity ~ RIR) for Day 1 and Day 2 separately
2. Extract slopes (velocity loss per RIR) and intercepts (baseline velocity)
3. Calculate MVT predictions for each day (predicted velocity at RIR = 0)
4. Compute ICC(2,1) - two-way random effects model
5. Calculate SEM (Standard Error of Measurement) and MDC95 (Minimal Detectable Change)

**ICC Interpretation (Koo & Li, 2016):**

| ICC | Interpretation |
|-----|----------------|
| < 0.50 | Poor |
| 0.50-0.75 | Moderate |
| 0.75-0.90 | Good |
| > 0.90 | Excellent |

The **SEM** represents the typical measurement error, while **MDC95** is the minimum change needed to be 95% confident that a true change has occurred (rather than measurement error).

### Results

```{r h3-results}
#| echo: false

cat("Slope ICC (velocity loss per RIR):\n")
cat("  ICC:", round(reliability$slope_icc$icc, 3), "\n")
cat("  95% CI:", round(reliability$slope_icc$ci_lower, 3), "-",
    round(reliability$slope_icc$ci_upper, 3), "\n")
cat("  Interpretation:", reliability$slope_icc$interpretation, "\n\n")

cat("MVT ICC (predicted failure velocity):\n")
cat("  ICC:", round(reliability$mvt_icc$icc, 3), "\n")
cat("  95% CI:", round(reliability$mvt_icc$ci_lower, 3), "-",
    round(reliability$mvt_icc$ci_upper, 3), "\n")
cat("  Interpretation:", reliability$mvt_icc$interpretation, "\n")
cat("  SEM:", round(reliability$mvt_icc$sem, 4), "m/s\n")
cat("  MDC95:", round(reliability$mvt_icc$mdc95, 4), "m/s\n")
```

```{r h3-plot}
#| fig-cap: "Day 1 vs Day 2 comparison of individual slopes"

day_params <- reliability$day_parameters

# Slopes comparison
ggplot(day_params, aes(x = slope_day1, y = slope_day2)) +
  geom_point(size = 3, alpha = 0.7) +
  geom_abline(slope = 1, intercept = 0, linetype = "dashed", color = "gray50") +
  geom_smooth(method = "lm", se = TRUE, color = "steelblue") +
  labs(x = "Slope Day 1 (m/s per RIR)", y = "Slope Day 2 (m/s per RIR)",
       title = "Day-to-Day Reliability of Individual Slopes",
       subtitle = paste("ICC =", round(reliability$slope_icc$icc, 2))) +
  theme_minimal()
```

```{r h3-mvt-plot}
#| fig-cap: "Day 1 vs Day 2 comparison of predicted MVT"

ggplot(day_params, aes(x = mvt_day1, y = mvt_day2)) +
  geom_point(size = 3, alpha = 0.7) +
  geom_abline(slope = 1, intercept = 0, linetype = "dashed", color = "gray50") +
  geom_smooth(method = "lm", se = TRUE, color = "steelblue") +
  labs(x = "MVT Day 1 (m/s)", y = "MVT Day 2 (m/s)",
       title = "Day-to-Day Reliability of Predicted MVT",
       subtitle = paste("ICC =", round(reliability$mvt_icc$icc, 2))) +
  theme_minimal()
```

### Interpretation

- **Slope reliability is moderate** (ICC = `r round(reliability$slope_icc$icc, 2)`), suggesting the rate of velocity decline per RIR is reasonably consistent
- **MVT reliability is poor** (ICC = `r round(reliability$mvt_icc$icc, 2)`), indicating that predicted failure velocity varies substantially between days
- **MDC95 = `r round(reliability$mvt_icc$mdc95, 3)` m/s** - changes in MVT smaller than this may represent measurement error rather than true change

**Practical recommendation:** Consider periodic recalibration (every 2-4 weeks) rather than relying on a single test session.

## H4: Polynomial vs Linear Model Comparison

### Research Question

**Does a quadratic model fit the velocity-RIR relationship better than linear?**

### Theoretical Background

The simplest model of the velocity-RIR relationship assumes **linear decay**---each additional rep costs the same amount of velocity. However, physiological fatigue often follows non-linear patterns:

- **Metabolic fatigue** (e.g., lactate accumulation, ATP depletion) may compound near failure
- **Neural fatigue** (motor unit dropout, decreased firing rates) may accelerate in later reps
- **Technical breakdown** often becomes more pronounced as fatigue accumulates

These factors suggest the velocity-RIR relationship might be **curvilinear**, with velocity dropping more rapidly near failure (small RIR values) than earlier in the set.

### Model Comparison Framework

We compare two models:

- **Linear**: velocity = β₀ + β₁(RIR) + ε
- **Quadratic**: velocity = β₀ + β₁(RIR) + β₂(RIR²) + ε

The quadratic model adds a curvature term. If β₂ < 0, velocity drops more rapidly near failure (accelerating decay). If β₂ ≈ 0, the relationship is approximately linear.

We use information criteria (AIC, BIC) rather than raw R² because they penalize model complexity---a quadratic model should only be preferred if the improvement justifies the added parameter.

### Methods

1. For each participant, fit:
   - Linear: velocity ~ RIR
   - Quadratic: velocity ~ RIR + RIR²
2. Compare using adjusted R², AIC, and BIC
3. Fit population-level LMM versions and conduct likelihood ratio test
4. Count how many participants show significantly better fit with quadratic

### Results

```{r h4-summary}
#| echo: false

cat("Individual Model Comparison:\n")
cat("  Participants analyzed:", poly_result$best_model_summary$n_participants, "\n")
cat("  Linear preferred:", poly_result$best_model_summary$n_linear_best, "\n")
cat("  Quadratic preferred:", poly_result$best_model_summary$n_quad_best,
    "(", round(poly_result$best_model_summary$pct_quad_best, 1), "%)\n")
cat("  Avg R² improvement (quad - linear):",
    round(poly_result$best_model_summary$avg_r2_improvement, 4), "\n")
```

```{r h4-plot}
#| fig-cap: "AIC comparison between linear and quadratic models by participant"

ind_results <- poly_result$individual_results

ggplot(ind_results, aes(x = reorder(id, delta_aic), y = delta_aic, fill = best_model)) +
  geom_col() +
  geom_hline(yintercept = -2, linetype = "dashed", color = "red") +
  geom_hline(yintercept = 2, linetype = "dashed", color = "red") +
  annotate("text", x = 1, y = -3, label = "Quadratic better", hjust = 0, color = "gray40") +
  annotate("text", x = 1, y = 3, label = "Linear better", hjust = 0, color = "gray40") +
  coord_flip() +
  labs(x = "Participant", y = "ΔAIC (Quadratic - Linear)",
       title = "Model Comparison by Participant",
       subtitle = "Negative values favor quadratic model",
       fill = "Best Model") +
  scale_fill_manual(values = c("linear" = "steelblue", "quadratic" = "coral")) +
  theme_minimal()
```

```{r h4-r2}
#| fig-cap: "R² comparison between linear and quadratic models"

ggplot(ind_results, aes(x = r2_adj_linear, y = r2_adj_quad)) +
  geom_point(aes(color = best_model), size = 3) +
  geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
  labs(x = "Adjusted R² (Linear)", y = "Adjusted R² (Quadratic)",
       title = "Model Fit Comparison",
       color = "Best Model") +
  scale_color_manual(values = c("linear" = "steelblue", "quadratic" = "coral")) +
  theme_minimal()
```

### Interpretation

Only `r round(poly_result$best_model_summary$pct_quad_best, 1)`% of participants show a meaningfully better fit with the quadratic model. This suggests:

1. **Linear model is generally adequate** for describing the velocity-RIR relationship
2. The additional complexity of a quadratic term is not justified for most individuals
3. Practitioners can confidently use **linear velocity zones** for training prescription

**Note:** While a minority of individuals may benefit from quadratic modeling, the linear approximation provides sufficient accuracy for practical applications.

## H5: Velocity Decay Rate Within Sets

### Research Question

**How does velocity loss per rep change as a set progresses?**

### Theoretical Background

While H4 examined the overall shape of the velocity-RIR curve, this analysis focuses on the **within-set dynamics**---specifically, whether velocity loss per rep is constant or accelerates as the set progresses.

Two competing hypotheses exist:

1. **Constant decay hypothesis**: Each rep costs approximately the same velocity, regardless of position in the set. This would suggest fatigue accumulates linearly.

2. **Accelerating decay hypothesis**: Later reps cost more velocity than earlier reps. This would suggest fatigue compounds---possibly due to metabolite accumulation, motor unit fatigue, or technique degradation.

The practical implications are significant:

- **Constant decay**: Simple rep-counting or fixed velocity loss thresholds work well
- **Accelerating decay**: Athletes should stop sets earlier than velocity loss alone might suggest, as the final reps represent disproportionate fatigue

### Why This Matters for Training Quality

If velocity decay accelerates near failure:

- **Rep quality deteriorates non-linearly**: The last 1-2 reps may be substantially lower quality than earlier reps
- **Technical breakdown risk increases**: Form often degrades as fatigue compounds
- **Recovery cost may be disproportionate**: The final grinding reps may cost more in recovery than they contribute to adaptation

Understanding decay patterns helps coaches make informed decisions about set termination criteria.

### Methods

1. Calculate rep-to-rep velocity change (Δv = v_n - v_{n-1})
2. Model decay rate vs rep number: Δv ~ rep_number
3. Test if decay accelerates (negative slope = accelerating fatigue)
4. Compare early reps (1-3) vs late reps (4+) decay rates

### Results

```{r h5-summary}
#| echo: false

cat("Velocity Decay Summary:\n")
cat("  Average decay per rep:", round(decay$decay_summary$avg_decay_per_rep, 4), "m/s\n")
cat("  Early reps (1-3):", round(decay$decay_summary$early_reps_decay, 4), "m/s\n")
cat("  Late reps (4+):", round(decay$decay_summary$late_reps_decay, 4), "m/s\n")
cat("  Acceleration:", round(decay$decay_summary$decay_acceleration, 4), "m/s\n\n")

cat("Acceleration Test:\n")
cat("  Slope:", round(decay$decay_acceleration$slope, 5), "\n")
cat("  p-value:", format(decay$decay_acceleration$p_value, digits = 4), "\n")
cat("  Interpretation:", decay$decay_acceleration$interpretation, "\n")
```

```{r h5-trajectory}
#| fig-cap: "Velocity trajectories for individual sets"

# Create spaghetti plot of velocity trajectories
ggplot(data, aes(x = rep_number, y = mean_velocity, group = set_id)) +
  geom_line(alpha = 0.3, color = "steelblue") +
  stat_summary(aes(group = 1), fun = mean, geom = "line",
               color = "darkred", linewidth = 1.5) +
  stat_summary(aes(group = 1), fun = mean, geom = "point",
               color = "darkred", size = 3) +
  labs(x = "Rep Number", y = "Mean Velocity (m/s)",
       title = "Velocity Trajectories Across Sets",
       subtitle = "Individual sets (blue) with population mean (red)") +
  theme_minimal()
```

```{r h5-decay}
#| fig-cap: "Rep-to-rep velocity change by rep number"

# Decay by rep number
decay_data <- decay$set_trajectories

ggplot(decay_data, aes(x = factor(rep_number), y = delta_v)) +
  geom_boxplot(fill = "steelblue", alpha = 0.7) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
  labs(x = "Rep Number", y = "Velocity Change from Previous Rep (m/s)",
       title = "Rep-to-Rep Velocity Change",
       subtitle = "Negative values indicate velocity loss") +
  theme_minimal()
```

### Interpretation

**Velocity decay accelerates as the set progresses** (p = `r format(decay$decay_acceleration$p_value, digits = 3)`):

- Early reps (1-3): Average decay = `r round(abs(decay$decay_summary$early_reps_decay) * 1000, 1)` mm/s per rep
- Late reps (4+): Average decay = `r round(abs(decay$decay_summary$late_reps_decay) * 1000, 1)` mm/s per rep

This `r round(abs(decay$decay_summary$decay_acceleration) * 1000, 1)` mm/s acceleration in decay rate suggests:

1. **Fatigue compounds near failure** - the last few reps cost more velocity than earlier reps
2. **Velocity thresholds are conservative early** - athletes have more "buffer" in early reps
3. **Quality deteriorates rapidly near failure** - this supports stopping 1-2 reps before failure for technique preservation

## H6: Early Rep Velocity for Failure Prediction

### Research Question

**Can the first 1-3 rep velocities predict when failure will occur?**

### Theoretical Background

The concept of using early-rep velocity to predict set capacity builds on the **load-velocity relationship** established in the VBT literature (González-Badillo & Sánchez-Medina, 2010). The fundamental insight is that first-rep velocity reflects:

1. **Relative intensity**: Faster first reps indicate lighter relative loads → more reps available
2. **Daily readiness**: Day-to-day fluctuations in strength affect first-rep velocity
3. **Fatigue state**: Accumulated fatigue reduces first-rep velocity

By combining first-rep velocity with the known velocity-RIR relationship, we can theoretically predict total set capacity before completing the set.

### Why This Matters for Practical Training

This analysis addresses the most practically valuable question for coaches and athletes:

1. **Real-time autoregulation**: Instead of counting reps or guessing RIR, athletes can use first-rep velocity to know approximately how many quality reps are available.

2. **Pre-set planning**: Before starting, athletes can perform a "velocity check" with the first rep to decide on set termination strategy.

3. **Daily autoregulation**: On days when first-rep velocity is unexpectedly low, athletes can adjust expectations and avoid overreaching.

### Leave-One-Set-Out Cross-Validation

We use leave-one-set-out cross-validation (LOOCV) to estimate prediction accuracy. For each set:

1. Fit the prediction model on all other sets
2. Predict the excluded set's total reps from its first-rep velocity
3. Calculate prediction error

This approach provides an honest estimate of how well the model generalizes to new data.

### Methods

1. For each set, extract: v1 (first rep velocity), v2, v3, and total reps
2. Build prediction models:
   - Model 1: reps ~ v1
   - Model 2: reps ~ v1 + v2
   - Model 3: reps ~ v1 + v2 + v3
   - Model 4: reps ~ v1 + load
3. Evaluate with leave-one-set-out cross-validation
4. Create practical lookup table

### Results

```{r h6-cv}
#| echo: false

cat("Leave-One-Set-Out Cross-Validation:\n")
cat("  Sets analyzed:", prediction$cv_results$n_sets, "\n")
cat("  MAE:", round(prediction$cv_results$mae, 2), "reps\n")
cat("  RMSE:", round(prediction$cv_results$rmse, 2), "reps\n")
cat("  R²:", round(prediction$cv_results$r2, 3), "\n")
cat("  Within ±1 rep:", round(prediction$cv_results$within_1_rep_pct, 1), "%\n")
cat("  Within ±2 reps:", round(prediction$cv_results$within_2_reps_pct, 1), "%\n")
```

```{r h6-lookup}
#| echo: false

kable(prediction$lookup_table,
      caption = "Practical Lookup Table: First Rep Velocity → Predicted Reps",
      digits = 1,
      col.names = c("First Rep Velocity (m/s)", "Predicted Reps", "Lower 95%", "Upper 95%"))
```

```{r h6-plot}
#| fig-cap: "First rep velocity vs total reps completed"

# Prepare set-level data
set_data <- do.call(rbind, lapply(unique(data$set_id), function(sid) {
  s <- data[data$set_id == sid, ]
  s <- s[order(s$rep_number), ]
  if (nrow(s) < 1) return(NULL)
  data.frame(
    set_id = sid,
    v1 = s$mean_velocity[1],
    reps_to_failure = s$reps_to_failure[1],
    load_percentage = s$load_percentage[1]
  )
}))

ggplot(set_data, aes(x = v1, y = reps_to_failure, color = load_percentage)) +
  geom_point(size = 3, alpha = 0.7) +
  geom_smooth(method = "lm", se = TRUE, aes(group = 1), color = "black") +
  labs(x = "First Rep Velocity (m/s)", y = "Total Reps to Failure",
       title = "Relationship Between First Rep Velocity and Set Capacity",
       color = "Load") +
  scale_color_manual(values = c("80%" = "#E41A1C", "90%" = "#377EB8")) +
  theme_minimal()
```

### Interpretation

The first rep velocity provides a **reasonable prediction of set capacity**:

- **MAE = `r round(prediction$cv_results$mae, 2)` reps** means predictions are typically within ~1 rep of actual
- **`r round(prediction$cv_results$within_2_reps_pct, 1)`% accuracy within ±2 reps** is sufficient for practical autoregulation
- **Each +0.1 m/s in first rep velocity → ~0.5 additional reps expected**

**Practical Application:**
Use the lookup table to estimate available reps from your first rep velocity. For example:
- First rep at 0.30 m/s → Expect ~6 reps (95% PI: 3-9)
- First rep at 0.45 m/s → Expect ~7 reps (95% PI: 3-10)

## Practical Implications

### Summary of Recommendations

| Finding | Practical Recommendation |
|---------|-------------------------|
| High MVT variability (CV = 31%) | Calibrate MVT individually for each athlete |
| Moderate slope reliability (ICC = 0.72) | Recalibrate velocity zones every 2-4 weeks |
| Linear model adequate | Use simple linear velocity zones |
| Decay accelerates near failure | Stop 1-2 reps from failure for quality |
| First rep predicts set capacity | Use first rep velocity for autoregulation |

### Implementation Steps

1. **Initial Calibration**: Test each athlete to failure at submaximal loads (75-85% 1RM) to establish individual MVT
2. **Set Up Zones**: Create linear velocity zones from MVT to maximum velocity
3. **Monitor First Rep**: Use first rep velocity to estimate available reps
4. **Stop Before Failure**: Given acceleration of velocity loss, target stopping 1-2 reps before predicted failure
5. **Recalibrate Periodically**: Update velocity zones every 2-4 weeks or after significant training blocks

## Limitations

This study has several limitations that should be considered:

1. **Sample size**: With 19 participants, statistical power is limited, particularly for subgroup analyses (e.g., sex differences). Effect sizes may be imprecise.

2. **Exercise specificity**: All findings apply specifically to the conventional deadlift. Sumo deadlifts, trap bar deadlifts, and other exercises may show different patterns.

3. **Load range**: Only 80% and 90% 1RM were tested. Lighter loads commonly used in hypertrophy training (60-75% 1RM) may exhibit different velocity dynamics.

4. **Short-term reliability only**: With only 2 testing days, we cannot assess longer-term reliability (week-to-week, month-to-month) or the effects of training adaptations on velocity profiles.

5. **Population specificity**: All participants were Portuguese resistance-trained individuals. Results may not generalize to different populations, training backgrounds, or skill levels (e.g., novice lifters).

6. **Prediction intervals**: The failure prediction lookup table is based on this sample only. Individual athletes may show systematic deviations from these population averages.

## Conclusions

This study provides novel insights into the velocity-RIR relationship for the conventional deadlift:

1. **MVT is highly variable** (CV ~31%), confirming that individual calibration is essential for accurate velocity-based prescriptions.

2. **Day-to-day reliability is moderate** for velocity-RIR slopes, suggesting periodic recalibration (every 2-4 weeks) is advisable.

3. **Linear models are generally adequate**, with only a minority of individuals showing meaningfully better fit with quadratic models.

4. **Velocity decay accelerates near failure**, supporting the practice of stopping sets 1-2 reps before failure to preserve rep quality.

5. **First-rep velocity predicts set capacity** with reasonable accuracy (~1-2 rep error), enabling practical real-time autoregulation.

These findings extend the evidence base for velocity-based training to the deadlift, while highlighting the importance of individualization and the limitations of universal velocity thresholds.

## References

- González-Badillo, J. J., & Sánchez-Medina, L. (2010). Movement velocity as a measure of loading intensity in resistance training. *International Journal of Sports Medicine*, 31(5), 347-352.

- Jukic, I., Prnjak, K., Helms, E. R., & McGuigan, M. R. (2024). Modeling the repetitions-in-reserve-velocity relationship: A valid method for resistance training monitoring and prescription, and fatigue management. *Experimental Physiology*, 109(2), 193-206.

- Koo, T. K., & Li, M. Y. (2016). A guideline of selecting and reporting intraclass correlation coefficients for reliability research. *Journal of Chiropractic Medicine*, 15(2), 155-163.

- Shrout, P. E., & Fleiss, J. L. (1979). Intraclass correlations: Uses in assessing rater reliability. *Psychological Bulletin*, 86(2), 420-428.

- Zourdos, M. C., Klemp, A., Dolan, C., Quiles, J. M., Schau, K. A., Jo, E., ... & Blanco, R. (2016). Novel resistance training–specific rating of perceived exertion scale measuring repetitions in reserve. *Journal of Strength and Conditioning Research*, 30(1), 267-275.

---

*Study 6 of the Deadlift RIR-Velocity Research Project*

*Part of Filipe Braga's MSc thesis research*

*Analysis performed using R `r R.version.string` with custom R6 classes following SOLID principles*
